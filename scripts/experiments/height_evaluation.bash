#!/bin/bash

# Script to run the evaluations on the 3D semantic reconstructions generated from different heights and methods
# (Reconstructions generated by height_experiment_suite.bash)

# Make sure to adjust MESH_RESULTS_PATH to where the reconstructions were generated

SCRIPT_DIR="$(dirname "$(readlink -f "$0")")"

MESH_RESULTS_PATH=$SCRIPT_DIR/../../kimera_ws/src/kimera_interface/mesh_results/height_evaluation

ROOMS=(frl_apartment_4 room_2 office_3) # frl_apartment_4 room_2 office_3
TRAJECTORIES=(0 1)
HEIGHTS=(0.2 0.8 1.2 1.8) # 0.2 0.8 1.2 1.8
METHODS=(gt mrcnn transfiner)

$SCRIPT_DIR/../apptainer/start.bash /home/szilvi/image_sandbox

for room in "${ROOMS[@]}"
do
    for trajectory in "${TRAJECTORIES[@]}"
    do
        for height in "${HEIGHTS[@]}"
        do

            # compare to gt to mrcnn
            $SCRIPT_DIR/../apptainer/exec.bash $SCRIPT_DIR/../run/compare_meshes.bash\
                $MESH_RESULTS_PATH/${room}_${height}_${trajectory}_gt.ply\
                $MESH_RESULTS_PATH/${room}_${height}_${trajectory}_mrcnn.ply\

            # compare to gt to transfiner
            $SCRIPT_DIR/../apptainer/exec.bash $SCRIPT_DIR/../run/compare_meshes.bash\
                $MESH_RESULTS_PATH/${room}_${height}_${trajectory}_gt.ply\
                $MESH_RESULTS_PATH/${room}_${height}_${trajectory}_transfiner.ply\
            
        done # HEIGHTS
    done # TRAJECTORIES
done # ROOMS

$SCRIPT_DIR/../apptainer/stop.bash